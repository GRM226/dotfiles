# ============================================
# CONFIGURATION TMUX - Th√®me Cr√®me & Pastel
# ============================================

# ============================================
# OPTIONS DE BASE
# ============================================

# Terminal
set-option -g default-terminal 'screen-256color'
set-option -g terminal-overrides ',xterm-256color:RGB'

# Pr√©fixe Ctrl+w
unbind C-b
set-option -g prefix C-w
bind-key C-w send-prefix

# Options g√©n√©rales
set -g base-index 1                    # commencer √† 1 au lieu de 0
setw -g pane-base-index 1              # idem pour les panneaux
set -g detach-on-destroy off           # ne pas quitter tmux en fermant une session
set -g escape-time 0                   # pas de d√©lai pour Escape
set -g history-limit 1000000           # historique √©norme
set -g renumber-windows on             # renum√©roter les fen√™tres automatiquement
set -g set-clipboard on                # utiliser le clipboard syst√®me
set -g status-position top             # barre de statut en haut (style macOS)
setw -g mode-keys vi                   # mode vi pour la copie

# ============================================
# RACCOURCIS CLAVIER
# ============================================

# Diviser les panneaux
unbind '"'
unbind %
bind ¬≤ split-window -h -c "#{pane_current_path}"    # ¬≤ pour diviser horizontalement
bind & split-window -v -c "#{pane_current_path}"    # & pour diviser verticalement

# Navigation entre panneaux avec Ctrl+jklm (sans pr√©fixe)
bind -n C-j select-pane -L   # gauche
bind -n C-k select-pane -D   # bas
bind -n C-l select-pane -U   # haut
bind -n C-m select-pane -R   # droite

# Redimensionner avec Ctrl+w puis fl√®ches (repeatable)
bind -r Left resize-pane -L 5
bind -r Right resize-pane -R 5
bind -r Up resize-pane -U 5
bind -r Down resize-pane -D 5

# Recharger la config
bind r source-file ~/.tmux.conf \; display "‚úÖ Config recharg√©e !"

# Tuer un panneau sans confirmation
bind x kill-pane

# Cr√©er une nouvelle fen√™tre
bind c new-window -c "#{pane_current_path}"

# Mode copie am√©lior√©
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"

# ============================================
# TH√àME - Cr√®me & Pastel (style Hyper)
# ============================================

# Bordures des panneaux
set -g pane-border-style 'fg=#3D3D3D,bg=default'
set -g pane-active-border-style 'fg=#A5C9E4,bg=default'

# Barre de statut (fond gris fonc√©, texte cr√®me)
set -g status-style bg='#2D2D2D',fg='#F5E6D3'

# Longueur des sections
set -g status-left-length 40
set -g status-right-length 80

# Section gauche (session)
set -g status-left "#[fg=#A5C9E4,bold] Û∞áò #S #[fg=#E4B4D4]‚îÇ "

# Section droite (r√©pertoire et heure)
set -g status-right "#[fg=#B4E4B4]#{b:pane_current_path} #[fg=#6D6D6D]‚îÇ #[fg=#F5E6A5,bold]%H:%M "

# Centrer les noms de fen√™tres
set -g status-justify centre

# Fen√™tres inactives
setw -g window-status-style fg='#6D6D6D',bg='#2D2D2D'
setw -g window-status-format " #I:#W "

# Fen√™tre active
setw -g window-status-current-style fg='#2D2D2D',bg='#A5C9E4',bold
setw -g window-status-current-format " #I:#W "

# Messages
set -g message-style bg='#A5C9E4',fg='#2D2D2D',bold

# Mode copie
setw -g mode-style bg='#A5C9E4',fg='#2D2D2D'

# ============================================
# PLUGINS
# ============================================

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'fcsonline/tmux-thumbs'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'wfxr/tmux-fzf-url'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'omerxx/tmux-floax'

# ============================================
# CONFIGURATION DES PLUGINS
# ============================================

# tmux-resurrect : sauvegarder/restaurer les sessions
set -g @resurrect-strategy-nvim 'session'

# tmux-continuum : sauvegarde automatique
set -g @continuum-restore 'on'

# tmux-sessionx : gestionnaire de sessions avec fzf
set -g @sessionx-bind 'o'                                    # Ctrl+w puis o pour ouvrir
set -g @sessionx-window-height '85%'
set -g @sessionx-window-width '75%'
set -g @sessionx-zoxide-mode 'on'
set -g @sessionx-filter-current 'false'
set -g @sessionx-auto-accept 'off'

# tmux-floax : terminal flottant
set -g @floax-bind 'p'                                       # Ctrl+w puis p pour ouvrir
set -g @floax-width '80%'
set -g @floax-height '80%'
set -g @floax-border-color '#A5C9E4'
set -g @floax-text-color '#F5E6D3'
set -g @floax-change-path 'true'

# tmux-fzf-url : ouvrir des URLs avec fzf
set -g @fzf-url-fzf-options '-p 60%,30% --prompt="üîó " --border-label=" Open URL "'
set -g @fzf-url-history-limit '2000'

# ============================================
# INITIALISER TPM (TOUJOURS EN DERNIER)
# ============================================

run '~/.tmux/plugins/tpm/tpm'
